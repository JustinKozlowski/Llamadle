(function(){"use strict";var e={475:function(e,t,s){var o=s(5130),n=s(6768);const a={id:"app"};function i(e,t,s,o,i,r){const l=(0,n.g2)("GameHelp"),c=(0,n.g2)("HelloWorld");return(0,n.uX)(),(0,n.CE)("div",a,[(0,n.bF)(l),(0,n.bF)(c)])}var r=s(4232);const l={class:"chat-app"},c={class:"target-phrase-banner"},d={class:"chat-window"},u={class:"chat-messages"},h={class:"message-content"},p={key:0,class:"warning-banner"},f={key:1,class:"winner-banner"},m={key:2,class:"chat-input"},g=["disabled"],v=["disabled"],k={class:"footer-section"},b={class:"difficulty-dropdown"},y={class:"token-count"};function w(e,t,s,a,i,w){return(0,n.uX)(),(0,n.CE)("div",l,[t[7]||(t[7]=(0,n.Lk)("h1",{class:"chat-title"},"Llamadle",-1)),(0,n.Lk)("div",c,' Target Phrase: "'+(0,r.v_)(i.phrase.phrase)+'" ',1),(0,n.Lk)("div",d,[(0,n.Lk)("div",u,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.messages.slice(0),((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:(0,r.C4)(["chat-message",e.role])},[(0,n.Lk)("p",h,(0,r.v_)(e.content),1)],2)))),128))]),i.warningMessage?((0,n.uX)(),(0,n.CE)("div",p,(0,r.v_)(i.warningMessage),1)):(0,n.Q3)("",!0),i.winner?((0,n.uX)(),(0,n.CE)("div",f,[(0,n.eW)(' ðŸŽ‰ Congratulations! You found the phrase: "'+(0,r.v_)(i.phrase.phrase)+'" ðŸŽ‰ ',1),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>w.loadNextPhrase&&w.loadNextPhrase(...e))},"Next")])):((0,n.uX)(),(0,n.CE)("div",m,[(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.prompt=e),placeholder:"Type your message...",rows:"2",disabled:i.loading,onKeydown:t[2]||(t[2]=(0,o.jR)((0,o.D$)(((...e)=>w.askPrompt&&w.askPrompt(...e)),["prevent"]),["enter"]))},null,40,g),[[o.Jo,i.prompt]]),(0,n.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>w.askPrompt&&w.askPrompt(...e)),disabled:i.loading||!i.prompt.trim()},(0,r.v_)(i.loading?"Loading...":"Send"),9,v)])),(0,n.Lk)("div",k,[(0,n.Lk)("div",b,[(0,n.bo)((0,n.Lk)("select",{id:"difficulty","onUpdate:modelValue":t[4]||(t[4]=e=>i.selectedDifficulty=e),onChange:t[5]||(t[5]=(...e)=>w.updateDifficulty&&w.updateDifficulty(...e))},t[6]||(t[6]=[(0,n.Lk)("option",{value:"easy"},"Easy",-1),(0,n.Lk)("option",{value:"medium"},"Medium",-1),(0,n.Lk)("option",{value:"hard"},"Hard",-1)]),544),[[o.u1,i.selectedDifficulty]])]),(0,n.Lk)("div",y,[(0,n.Lk)("p",null,"Total Tokens: "+(0,r.v_)(i.tokenCount>0?i.tokenCount:0),1)])])])])}s(4114),s(8111),s(116);var L=s(6463);const C="Llama-3.1-8B-Instruct-q4f16_1-MLC-1k";let P=null,M=!1,W=0;async function x(){const e=e=>{console.log(e);const t=e.text.match(/(\d+)%/);t&&(W=parseInt(t[1],10))};P=await(0,L.L6)(C,{initProgressCallback:e}),W=100,M=!0}function E(){return W}function T(){return P}function _(){return M}var D=s(144);const X=[{phrase:"An Apple a day",difficulty:{easy:["apple"],medium:["apple","day"],hard:["apple","day","doctor"]}},{phrase:"Early bird catches the worm",difficulty:{easy:["bird","worm"],medium:["bird","worm","catches","early"],hard:["bird","worm","catches","early"]}}];function O(){return X}var A={name:"WebLLMComponent",data(){return{prompt:"",messages:[],loading:!1,phrase:O()[0],bannedWords:O()[0].difficulty[this.selectedDifficulty],winner:!1,tokenCount:-10,preprocessed:!1,warningMessage:"",selectedDifficulty:"medium"}},methods:{checkForWinner(e,t){return console.log(t),console.log(e),e.toLowerCase().includes(t.toLowerCase())},makeWinner(){this.winner=!0},containsBannedWords(e){return console.log(this.bannedWords),console.log(this.phrase),console.log(this.selecteddifficulty),this.bannedWords.find((t=>e.toLowerCase().includes(t.toLowerCase())))},async askPrompt(){if(this.winner=!1,this.warningMessage="",!_())return void(this.warningMessage="Model is not loaded yet. Please wait.");if(!this.prompt.trim())return void(this.warningMessage="Please enter a prompt.");const e=this.containsBannedWords(this.prompt);if(e)this.warningMessage=`Your prompt contains a banned word: "${e}". Please revise it.`;else try{this.loading=!0;const e={role:"user",content:(0,D.ux)(this.prompt)};this.messages.push(e);const t=[{role:"system",content:"Respond in 1 sentence"},...(0,D.ux)(this.messages)],s=await T().chat.completions.create({messages:t});this.tokenCount+=s.usage.prompt_tokens-5;const o=s.choices[0].message.content,n={role:"assistant",content:o};this.messages.push(n),this.checkForWinner(o,this.phrase.phrase)&&this.makeWinner()}finally{this.loading=!1,this.prompt="",this.$nextTick((()=>{const e=this.$el.querySelector("textarea");e&&e.focus()}))}},updateDifficulty(){this.bannedWords=this.phrase.difficulty[this.selectedDifficulty],this.winner=!1,this.messages=[],this.tokenCount=-10},loadNextPhrase(){const e=O(),t=e.findIndex((e=>e.phrase===this.phrase.phrase)),s=(t+1)%e.length;this.phrase=e[s],this.updateDifficulty(),this.winner=!1,this.messages=[],this.tokenCount=-10},scrollToBottom(){this.$nextTick((()=>{const e=this.$el.querySelector(".chat-messages");e&&(e.scrollTop=e.scrollHeight)}))}},mounted(){this.updateDifficulty(),this.scrollToBottom()},updated(){this.scrollToBottom()}},G=s(1241);const H=(0,G.A)(A,[["render",w],["__scopeId","data-v-a258cc1e"]]);var U=H;const I={key:0,class:"gpu-message"},j={key:1,class:"mobile-message"},$={key:2},B=["disabled"];function F(e,t,s,a,i,l){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=e=>i.showModal=!0)},"How to Play"),i.showModal?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"modal-overlay",onClick:t[3]||(t[3]=(...e)=>l.closeModal&&l.closeModal(...e))},[(0,n.Lk)("div",{class:"modal-content",onClick:t[2]||(t[2]=(0,o.D$)((()=>{}),["stop"]))},[i.hasWebGPU?i.isMobile?((0,n.uX)(),(0,n.CE)("div",j," You appear to be visiting on mobile. This game is best experienced on desktop. Expect performance issues. ")):(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",I," This game requires WebGPU enabled. Please use a browser that supports WebGPU. Avoid mobile browsers for perfomance reasons. ")),t[5]||(t[5]=(0,n.Lk)("h2",null,"How to Play",-1)),t[6]||(t[6]=(0,n.Lk)("p",null," Welcome to Llamadle! The goal of the game is to prompt the LLM to guess the secret phrase. Try to reach the phrase in the fewest tokens possible! ",-1)),i.engineLoaded?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",$,[t[4]||(t[4]=(0,n.Lk)("p",null," LLM is downloading. This will be faster on subsequent visits. ",-1)),(0,n.eW)(" Download Progress: "+(0,r.v_)(i.downloadProgress)+"% ",1)])),(0,n.Lk)("button",{disabled:!i.engineLoaded||!i.hasWebGPU,onClick:t[1]||(t[1]=(...e)=>l.closeModal&&l.closeModal(...e))},"Close",8,B)])])):(0,n.Q3)("",!0)])}var q={name:"HelpModal",data(){return{showModal:!0,downloadProgress:0,engineLoaded:!1,isMobile:!1,hasWebGPU:!1}},mounted(){this.isMobile=/Mobi|Android/i.test(navigator.userAgent),this.hasWebGPU=!!navigator.gpu,this.updateProgress()},methods:{closeModal(){(this.engineLoaded||this.hasWebGPU)&&(this.showModal=!1)},updateProgress(){const e=setInterval((()=>{this.downloadProgress=E(),this.engineLoaded=_(),this.engineLoaded&&clearInterval(e)}),500)}}};const N=(0,G.A)(q,[["render",F],["__scopeId","data-v-06ea90bc"]]);var Q=N,S={name:"App",components:{HelloWorld:U,GameHelp:Q}};const Y=(0,G.A)(S,[["render",i]]);var K=Y;(0,o.Ef)(K).mount("#app"),(async()=>{await x()})()}},t={};function s(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,o,n,a){if(!o){var i=1/0;for(d=0;d<e.length;d++){o=e[d][0],n=e[d][1],a=e[d][2];for(var r=!0,l=0;l<o.length;l++)(!1&a||i>=a)&&Object.keys(s.O).every((function(e){return s.O[e](o[l])}))?o.splice(l--,1):(r=!1,a<i&&(i=a));if(r){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,n,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,a,i=o[0],r=o[1],l=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(l)var d=l(s)}for(t&&t(o);c<i.length;c++)a=i[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(d)},o=self["webpackChunkllamadle"]=self["webpackChunkllamadle"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],(function(){return s(475)}));o=s.O(o)})();
//# sourceMappingURL=app.8b3250b0.js.map