(function(){"use strict";var e={7686:function(e,t,s){var n=s(5130),o=s(6768);const a={id:"app"};function i(e,t,s,n,i,r){const l=(0,o.g2)("GameHelp"),c=(0,o.g2)("HelloWorld");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(l),(0,o.bF)(c)])}var r=s(4232);const l={class:"chat-app"},c={class:"target-phrase-banner"},d={class:"chat-window"},u={class:"chat-messages"},h={class:"message-content"},p={key:0,class:"warning-banner"},f={key:1,class:"winner-banner"},m={key:2,class:"chat-input"},g=["disabled"],v=["disabled"],k={class:"footer-section"},y={class:"difficulty-dropdown"},w={class:"token-count"};function b(e,t,s,a,i,b){return(0,o.uX)(),(0,o.CE)("div",l,[t[7]||(t[7]=(0,o.Lk)("h1",{class:"chat-title"},"Llamadle",-1)),(0,o.Lk)("div",c,' Target Phrase: "'+(0,r.v_)(i.phrase.phrase)+'" ',1),(0,o.Lk)("div",d,[(0,o.Lk)("div",u,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.messages.slice(0),((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:(0,r.C4)(["chat-message",e.role])},[(0,o.Lk)("p",h,(0,r.v_)(e.content),1)],2)))),128))]),i.warningMessage?((0,o.uX)(),(0,o.CE)("div",p,(0,r.v_)(i.warningMessage),1)):(0,o.Q3)("",!0),i.winner?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.eW)(' ðŸŽ‰ Congratulations! You found the phrase: "'+(0,r.v_)(i.phrase.phrase)+'" ðŸŽ‰ ',1),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>b.loadNextPhrase&&b.loadNextPhrase(...e))},"Next")])):((0,o.uX)(),(0,o.CE)("div",m,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.prompt=e),placeholder:"Type your message...",rows:"2",disabled:i.loading,onKeydown:t[2]||(t[2]=(0,n.jR)((0,n.D$)(((...e)=>b.askPrompt&&b.askPrompt(...e)),["prevent"]),["enter"]))},null,40,g),[[n.Jo,i.prompt]]),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>b.askPrompt&&b.askPrompt(...e)),disabled:i.loading||!i.prompt.trim()},(0,r.v_)(i.loading?"Loading...":"Send"),9,v)])),(0,o.Lk)("div",k,[(0,o.Lk)("div",y,[(0,o.bo)((0,o.Lk)("select",{id:"difficulty","onUpdate:modelValue":t[4]||(t[4]=e=>i.selectedDifficulty=e),onChange:t[5]||(t[5]=(...e)=>b.updateDifficulty&&b.updateDifficulty(...e))},t[6]||(t[6]=[(0,o.Lk)("option",{value:"easy"},"Easy",-1),(0,o.Lk)("option",{value:"medium"},"Medium",-1),(0,o.Lk)("option",{value:"hard"},"Hard",-1)]),544),[[n.u1,i.selectedDifficulty]])]),(0,o.Lk)("div",w,[(0,o.Lk)("p",null,"Total Tokens: "+(0,r.v_)(i.tokenCount>0?i.tokenCount:0),1)])])])])}s(4114),s(8111),s(116);var L=s(6463);const C="Llama-3.2-1B-Instruct-q4f32_1-MLC";let M=null,P=!1,x=0;async function W(){const e=e=>{console.log(e);const t=e.text.match(/(\d+)%/);t&&(x=parseInt(t[1],10))};M=await(0,L.L6)(C,{initProgressCallback:e}),x=100,P=!0}function E(){return x}function T(){return M}function _(){return P}var D=s(144);const O=[{phrase:"An Apple a day",difficulty:{easy:["apple"],medium:["apple","day"],hard:["apple","day","doctor"]}},{phrase:"Early bird catches the worm",difficulty:{easy:["bird","worm"],medium:["bird","worm","catches","early"],hard:["bird","worm","catches","early"]}}];function X(){return O}var H={name:"WebLLMComponent",data(){return{prompt:"",messages:[],loading:!1,phrase:X()[0],bannedWords:X()[0].difficulty[this.selectedDifficulty],winner:!1,tokenCount:-10,preprocessed:!1,warningMessage:"",selectedDifficulty:"medium"}},methods:{checkForWinner(e,t){return console.log(t),console.log(e),e.toLowerCase().includes(t.toLowerCase())},makeWinner(){this.winner=!0},containsBannedWords(e){return console.log(this.bannedWords),console.log(this.phrase),console.log(this.selecteddifficulty),this.bannedWords.find((t=>e.toLowerCase().includes(t.toLowerCase())))},async askPrompt(){if(this.winner=!1,this.warningMessage="",!_())return void(this.warningMessage="Model is not loaded yet. Please wait.");if(!this.prompt.trim())return void(this.warningMessage="Please enter a prompt.");const e=this.containsBannedWords(this.prompt);if(e)this.warningMessage=`Your prompt contains a banned word: "${e}". Please revise it.`;else try{this.loading=!0;const e={role:"user",content:(0,D.ux)(this.prompt)};this.messages.push(e);const t=[{role:"system",content:"Respond in 1 sentence"},...(0,D.ux)(this.messages)],s=await T().chat.completions.create({messages:t});this.tokenCount+=s.usage.prompt_tokens-5;const n=s.choices[0].message.content,o={role:"assistant",content:n};this.messages.push(o),this.checkForWinner(n,this.phrase.phrase)&&this.makeWinner()}finally{this.loading=!1,this.prompt="",this.$nextTick((()=>{const e=this.$el.querySelector("textarea");e&&e.focus()}))}},updateDifficulty(){this.bannedWords=this.phrase.difficulty[this.selectedDifficulty],this.winner=!1,this.messages=[],this.tokenCount=-10},loadNextPhrase(){const e=X(),t=e.findIndex((e=>e.phrase===this.phrase.phrase)),s=(t+1)%e.length;this.phrase=e[s],this.updateDifficulty(),this.winner=!1,this.messages=[],this.tokenCount=-10},scrollToBottom(){this.$nextTick((()=>{const e=this.$el.querySelector(".chat-messages");e&&(e.scrollTop=e.scrollHeight)}))}},mounted(){this.updateDifficulty(),this.scrollToBottom()},updated(){this.scrollToBottom()}},A=s(1241);const I=(0,A.A)(H,[["render",b],["__scopeId","data-v-a258cc1e"]]);var j=I;const $={key:0,class:"mobile-message"},B={key:0},F=["disabled"];function q(e,t,s,a,i,l){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=e=>i.showModal=!0)},"How to Play"),i.showModal?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:t[3]||(t[3]=(...e)=>l.closeModal&&l.closeModal(...e))},[i.isMobile?((0,o.uX)(),(0,o.CE)("div",$," You appear to be visiting on mobile. This game is best experienced on desktop with a GPU as this game requires WebGPU support. Expect performance issues. ")):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:"modal-content",onClick:t[2]||(t[2]=(0,n.D$)((()=>{}),["stop"]))},[t[5]||(t[5]=(0,o.Lk)("h2",null,"How to Play",-1)),t[6]||(t[6]=(0,o.Lk)("p",null," Welcome to Llamadle! The goal of the game is to prompt the LLM to guess the secret phrase. Try to reach the phrase in the fewest tokens possible! ",-1)),i.engineLoaded?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",B,[t[4]||(t[4]=(0,o.Lk)("p",null," LLM is downloading. This will be faster on subsequent visits. ",-1)),(0,o.eW)(" Download Progress: "+(0,r.v_)(i.downloadProgress)+"% ",1)])),(0,o.Lk)("button",{disabled:!i.engineLoaded,onClick:t[1]||(t[1]=(...e)=>l.closeModal&&l.closeModal(...e))},"Close",8,F)])])):(0,o.Q3)("",!0)])}var G={name:"HelpModal",data(){return{showModal:!0,downloadProgress:0,engineLoaded:!1,isMobile:!1}},mounted(){this.isMobile=/Mobi|Android/i.test(navigator.userAgent),this.updateProgress()},methods:{closeModal(){this.engineLoaded&&(this.showModal=!1)},updateProgress(){const e=setInterval((()=>{this.downloadProgress=E(),this.engineLoaded=_(),this.engineLoaded&&clearInterval(e)}),500)}}};const N=(0,A.A)(G,[["render",q],["__scopeId","data-v-978c71fe"]]);var Q=N,U={name:"App",components:{HelloWorld:j,GameHelp:Q}};const S=(0,A.A)(U,[["render",i]]);var Y=S;(0,n.Ef)(Y).mount("#app"),(async()=>{await W()})()}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,a){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],a=e[d][2];for(var r=!0,l=0;l<n.length;l++)(!1&a||i>=a)&&Object.keys(s.O).every((function(e){return s.O[e](n[l])}))?n.splice(l--,1):(r=!1,a<i&&(i=a));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,o,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,i=n[0],r=n[1],l=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var d=l(s)}for(t&&t(n);c<i.length;c++)a=i[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(d)},n=self["webpackChunkllamadle"]=self["webpackChunkllamadle"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(7686)}));n=s.O(n)})();
//# sourceMappingURL=app.e575271c.js.map